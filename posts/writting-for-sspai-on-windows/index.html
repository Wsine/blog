<!doctype html><html lang=en><head><meta http-equiv=Content-Type content="text/html" charset=UTF-8><meta http-equiv=X-UA-Compatible content="IE=edge, chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><title>Wsine's Blog</title>
<link rel=stylesheet href=https://fonts.xz.style/serve/inter.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css></head><body><header><h1><a href=/ style=color:inherit;text-decoration:none>Wsine's Blog</a></h1><nav><a href=/>Home</a> /
<a href=/memos>Memos</a> /
<a href=/social>Social</a> /
<a href=/feed.xml>Subscribe</a></nav></header><p name=#top><b>Posted on: 2020 Jun 02</b></p><p>谈及写作，不少的用户都是使用 Mac 平台配合多样的 App 完成从写稿到发布的一条龙服务。但是在 Windows 平台上，往往需要很多手动的过程。比如，在少数派平台上，官方提供了专用的接口给 MWeb App 完成从写稿、插图、发布的完善服务，但是 MWeb App 仅在 Mac 平台上提供，Windows 用户常常因为插图图床问题困扰。</p><p>最近，随着两大写作好伴侣 App 的更新，这一情况得以改善。PicGo 迎来了 v2.0 版本的大更新，剥离了核心功能同时支持 CLI 调用和 API 调用。Typora 集成了 PicGo 并提供一键上传图片服务。如果需要更详细的资料，请看这两篇文章：</p><p><a href=https://sspai.com/post/52527>图床「神器」PicGo v2.0更新，插件系统终于来了</a></p><p><a href=https://sspai.com/post/59128>Typora 支持自定义图片上传服务了</a></p><p>配合上述两大神器，是否有方法能够改善少数派平台上的写作流程，下面我就来谈谈我的方案。</p><h2 id=typora-之功能增强>Typora 之功能增强</h2><p>首先，从 Typora 官网上能够下载 Win / Linux / OSX 对应平台的安装文件并正确安装。</p><p>然后，我们需要启用图片上传功能。点击 File -> Preferences -> Image，在 Image Upload Setting 那栏，选择 PicGo-Core (command line) ，然后点击 Download and Upgrade，即可完成安装。</p><p><img src=https://image.wsine.top/628cb7601505f1aaf9d736a4f59f68a6.png alt=enhance></p><h2 id=picgo-之少数派插件>PicGo 之少数派插件</h2><p>得益于 PicGo 的插件系统，我们可以为少数派平台编写插件，快捷完成图片上传到少数派的服务器。那么，如何安装少数派插件？</p><p>步骤一</p><p>首先我们打开 PicGo 配置文件所在的目录，你可以点击上图的 Open Config File 按钮，或者手动打开对应平台的文件夹。</p><p>Windows 平台位于<code>C:\Users\&lt;your username>\.picgo\</code></p><p>Linux 和 OSX 平台位于`~/.picgo/``</p><p>然后，克隆或下载<a href=https://github.com/Wsine/picgo-plugin-sspai>github.com/Wsine/picgo-plugin-sspai</a>仓库到该文件夹中，注意如果从网页端下载，解压后去除多余的分支名，这很重要。</p><p>步骤二</p><p>在 PicGo 配置文件夹下创建<code>node_modules</code>文件夹，并在里面创建同名快捷方式/软链接，指向刚才下载的仓库文件夹。</p><p>步骤三</p><p>编辑`package.json``文件，修改里面的依赖项。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;dependencies&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;picgo-plugin-sspai&#34;</span>: <span style=color:#e6db74>&#34;file:picgo-plugin-sspai&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>步骤四</p><p>创建`package-lock.json``，内容填充如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;picgo-plugins&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;requires&#34;</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;lockfileVersion&#34;</span>: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;dependencies&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;picgo-plugin-sspai&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;file:picgo-plugin-sspai&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>验证</p><p>最终配置文件夹中的目录结构如应如下图所示</p><pre tabindex=0><code>~/.picgo &gt; tree
.
├── config.json
├── node_modules
│   └── picgo-plugin-sspai &lt;soft link&gt;
├── package.json
├── package-lock.json
├── picgo.log
└── picgo-plugin-sspai
    ├── index.js
    ├── License
    ├── md5.min.js
    ├── package.json
    └── README.md
</code></pre><h2 id=配置个人信息>配置个人信息</h2><p>打开少数派官网，登陆自己的账号，然后按F12打开开发者模式，找到 Console 选项卡，输入</p><p>`document.cookie.split(&rsquo;; sspai_cross_token=&rsquo;).pop().split(&rsquo;;&rsquo;).shift()``</p><p>该命令会返回一串字符串，记住该字符串，并重新在 Typora 中打开 PicGo 的配置文件，替换下面样例的 token 占位符，保存</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;picBed&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;current&#34;</span>: <span style=color:#e6db74>&#34;sspai&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;uploader&#34;</span>: <span style=color:#e6db74>&#34;sspai&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;transformer&#34;</span>: <span style=color:#e6db74>&#34;base64&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;sspai&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;cross_token&#34;</span>: <span style=color:#e6db74>&#34;&lt;replace here&gt;&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;picgoPlugins&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;picgo-plugin-sspai&#34;</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>好了，至此为止，你已完成了全部的配置，那么来看看效果如何吧。</p><h2 id=样例效果>样例效果</h2><p>我们就以本文作为目标图片展示一下该写作流程的优化吧，通过菜单栏的 Format -> Image -> Upload All Local Images 能够一键上传该文章下面的全部图片，也可以通过右击图片的方式单张图片上传</p><p><img src=https://image.wsine.top/4472f6471191c61072d1e54de3f941d9.gif alt=example></p><p>最后，打开少数派网站的编辑器，复制全文富文本格式进去，即可完成发布流程。</p><h2 id=后记>后记</h2><p>该插件的开发仅仅是为了方便用户在少数派平台上写作而创作。图床，一直是流量消耗的大户，目前少数派的图床仅能在 sspai.com 域名下显示，也即启用的防盗链技术，如有别的用途的用户就不用折腾啦。</p><p>等后续的 Typora 更新了发布功能，我会再来优化该流程。那么，希望这个插件能帮得到大家。</p><p style=text-align:right><a href=#top>↑ Back to Top</a></p><div style=margin-top:3rem></div><p>Contact me if you have any comments or questions about this aritcle.</p><p>Appriciate if you would like to support me if the article really helps you.</p><iframe src=https://github.com/sponsors/Wsine/button title="Sponsor Wsine" height=32 width=114 style=border:0;border-radius:6px;float:right></iframe><div style=margin-bottom:5rem></div><footer style=color:grey;text-align:center>Copyright &copy; 2019-Now &#183; CC <a style=color:grey href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en>BY-NC-SA 4.0</a> &#183; Powered by <a style=color:grey href=https://gohugo.io/>Hugo</a></footer></body></html>